# space_ship

ITMO project

## Logbook

Основанный на clickhouse набор журналов, содержащих данные о работе гипотетического космического корабля

### Entities

* control_action - описывает команду, когда-либо выданную системе управления кораблем (например, повернуть налево или снять показания датчиков космического излучения по левому борту)
* position - описывет скорость и положение корабля в космосе в данный момент времени при помощи трех координат : x, y, z, угла между продольной осью корабля и осью OX (угол атаки), угла между проекцией продольной осью корабля на плоскость XOY и осью OX (угол направления)
* sensor_data - содержит показания приборов в данный момент времени (например, концентрация холодной темной материи у верхнего края корабля)
* system_state - предназначена для мониторинга состояния систем корабля

### Prerequisites

Требуются установленные:

#### clickhouse-server

Cобственно сервер, на котором будет лежать база данных

Установка производится так:

Прописать в  **/etc/apt/sources.list** репозиторий **deb http://repo.yandex.ru/clickhouse/deb/stable/ main/**

Выполнить команды

    sudo apt-get update
    sudo apt-get install clickhouse-client clickhouse-server-common

#### infi.clickhouse_orm

Модуль для python, с помощью которого идет взаимодействие с БД

Устанавливается командой

    pip install infi.clickhouse_orm
  
### Running

#### Server

Выполнить команду

    sudo clickhouse-server --config-file=/etc/clickhouse-server/config.xml
  
#### Client

Для выполнения SQL запросов в командной строке. Запускается командой

    clickhouse-client
  
#### Scripts

После запуска сервера необходимо сначала инициализировать базу данных соответствующими таблицами

    DB_URL=http://127.0.0.1:8123 DB_NAME=logbook python3 initialize.py
  
Проверить в клиенте что все таблицы созданы

    show tables from logbook
  
Заполнить базу данных значениями, если они были заранее сгенерированы

    DB_URL=http://127.0.0.1:8123 DB_NAME=logbook python3 fill.py
  
В противном случае сначла сгенерировать значения (следующая команда запускается из папки generators)
  
    python3 main.py
  
В скрипте можно изменять объем данных для генерации
  
Далее можно проверить что все прошло успешно запуском ряда простых манипуляций с данными

    DB_URL=http://127.0.0.1:8123 DB_NAME=logbook python3 explore.py
  


  
